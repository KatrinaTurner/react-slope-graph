/*! For license information please see module.js.LICENSE.txt */
define(["d3","react","@grafana/data"],(function(t,e,r){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r(r.s=3)}([function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e){t.exports=r},function(t,e,r){"use strict";r.r(e);var n=r(2);var a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var a in e=arguments[r])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};var o=r(1),i=r.n(o);var s=r(0);function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerID=e}var e,r,n;return e=t,(r=[{key:"renderGraph",value:function(t,e,r,n,a){if(t){s.select("#"+this.containerID).select("svg").remove(),s.select("#"+this.containerID).select(".tooltip").remove();var o=t.topPairs,i=t.srcOrgs,l=t.destOrgs;t.alpha,t.color_palette,o[o.length-1][2],o[0][2],console.log("rendering Graph...");var u=document.getElementById(this.containerID).offsetWidth;document.getElementById(this.containerID).offsetHeight,console.log(this.containerID,o);var c=50,d=400,p=25,f=400,h=u-f-d,g=e-c-p,v=s.select("#"+this.containerID).append("svg").attr("width",h+f+d).attr("height",g+c+p).append("g").attr("transform","translate("+f+","+c+")"),m=s.scaleLinear().domain([0,1]).range([0,h]),b=s.scaleLinear().domain([0,i.length-1]).range([0,g]),y=s.scaleLinear().domain([0,l.length-1]).range([0,g]),x=s.axisLeft(b).tickSize(5).ticks(i.length).tickFormat((function(t){return i[t]})),I=s.axisRight(y).tickSize(5).ticks(l.length).tickFormat((function(t){return l[t]}));v.append("g").call(x).attr("class","axis").attr("margin",10).selectAll(".tick text").call(O,f-50).attr("transform","translate(-10,0)"),v.append("g").attr("transform","translate("+h+",0)").call(I).attr("class","axis").selectAll(".tick text").call(O,d-50).attr("transform","translate(10,0)"),s.scaleLinear().domain([o[o.length-1][2],o[0][2]]).range([3,15]);var w=s.select("body").append("div").attr("class","tooltip").style("opacity",0);o.forEach((function(t){t[2],v.append("path").datum(t.coords).attr("fill","none").attr("stroke",(function(t){return t[0].color})).attr("stroke-width",8).attr("d",s.line().x((function(t){return m(t.x)})).y((function(t){return 0==t.x?b(t.y):y(t.y)}))).on("mouseover",(function(t){s.select(this).attr("stroke","orange").attr("class","path-hover"),w.transition().duration(200).style("opacity",.9),w.html((function(){return"<p><b>Source:</b> "+t[0].source+"</p><p><b>Destination:</b> "+t[0].dest+"</p><p><b>Volume:</b> "+t[0].displayValue})).style("left",s.event.pageX+"px").style("top",s.event.pageY-28+"px")})).on("mouseout",(function(t){w.transition().duration(500).style("opacity",0),s.select(this).attr("stroke",(function(){return t[0].color}))}))})),v.append("text").attr("class","header-text").attr("transform","translate("+-f/2+","+-c/2+")").attr("text-anchor","center").text(n),v.append("text").attr("class","header-text").attr("transform","translate("+(h+d/5)+","+-c/2+")").attr("text-anchor","center").text(a)}function O(t,e){t.each((function(){for(var t,r=s.select(this),n=r.text().split(/\s+/).reverse(),a=[],o=0,i=r.attr("y"),l=parseFloat(r.attr("dy")),u=r.text(null).append("tspan").attr("x",0).attr("y",i).attr("dy",l+"em");t=n.pop();)a.push(t),u.text(a.join(" ")),u.node().getComputedTextLength()>e&&(a.pop(),u.text(a.join(" ")),a=[t],u=r.append("tspan").attr("x",0).attr("y",i).attr("dy",1.1*++o+l+"em").text(t))}))}}}])&&l(e.prototype,r),n&&l(e,n),t}(),c=function(t){return Object(o.useEffect)((function(){console.log("rendering");var e=t.panelId,r=new u("Chart_"+e);console.log(r),r.renderGraph(t.data,t.height,t.width,t.options.leftHeader,t.options.rightHeader)})),i.a.createElement("div",{id:"Chart_"+t.panelId,style:{height:t.height,width:t.width}})};r.d(e,"plugin",(function(){return d}));var d=new n.PanelPlugin((function(t){var e=t.options,r=t.data,n=t.width,o=t.height,s=t.id,l=a({},e),u=function(t,e){console.log("react num pairs:"+e),console.log("react data:"),console.log(t);var r=t.series[0].fields,n=[];for(var a in r[0].values.buffer){var o=[r[0].values.buffer[a],r[1].values.buffer[a],r[2].values.buffer[a]];n.push(o)}console.log("transformed data"),console.log(n);var i=n.sort((function(t,e){return e[2]-t[2]})),s=i.slice(0,Math.min(e,i.length)),l=[],u=[],c=0;for(var a in s){var d=s[a][0],p=!1;for(var f in s[a].coords=[{x:0,value:s[a][2]},{x:1}],l)if(l[f]==d){p=!0,u.push(parseInt(f)),s[a].coords[0].y=parseInt(f);break}p||(l.push(d),u.push(c),s[a].coords[0].y=c,c++)}var h=[],g=[];for(var a in c=0,s){var v=s[a][1],m=!1;for(var f in h)if(h[f]==v){m=!0,g.push(parseInt(f)),s[a].coords[1].y=parseInt(f);break}m||(h.push(v),g.push(c),s[a].coords[1].y=c,c++)}var b=["rgba(196, 199, 254, 0.6)","rgba(171, 176, 253, 0.6)","rgba(146, 152, 248, 0.6)","rgba(122, 130, 246, 0.6)","rgba(106, 115, 245, 0.6)","rgba(85, 95, 244, 0.6)","rgba(56, 67, 241, 0.6)","rgba(23, 36, 238, 0.6)","rgba(2, 14, 202, 0.6)","rgba(3, 12, 158, 0.6)"],y=s[0][2];for(var a in console.log("max val: "+y),s){var x=Math.ceil(s[a][2]/y*10);x>0&&x--,s[a].coords[0].color=b[x],s[a].coords[0].source=s[a][0],s[a].coords[0].dest=s[a][1];var I=s[a].coords[0].value/1e3,w=I;w=I<1e3?Math.round(10*I)/10+" KB":(I/=1e3)<1e3?Math.round(10*I)/10+" MB":(I/=1e3)<1e3?Math.round(10*I)/10+" GB":(I/=1e3)<1e3?Math.round(10*I)/10+" TB":Math.round(10*I)/10+" PB",s[a].coords[0].displayValue=w}return console.log(s),{srcOrgs:l,destOrgs:h,topPairs:s}}(r,l.numLines);return console.log(u),console.log(l),i.a.createElement(c,{height:o,width:n,panelId:s,options:l,data:u})})).setPanelOptions((function(t){return t.addTextInput({path:"text",name:"Simple text option",description:"Description of panel option",defaultValue:"Default value of text input option"}).addBooleanSwitch({path:"showSeriesCount",name:"Show series counter",defaultValue:!1}).addRadio({path:"seriesCountSize",defaultValue:"sm",name:"Series counter size",settings:{options:[{value:"sm",label:"Small"},{value:"md",label:"Medium"},{value:"lg",label:"Large"}]},showIf:function(t){return t.showSeriesCount}}).addNumberInput({path:"numLines",name:"Number of Lines to Display",defaultValue:10}).addTextInput({path:"leftHeader",name:"Left Column Header",defaultValue:"Left Title"}).addTextInput({path:"rightHeader",name:"Right Column Header",defaultValue:"Right Title"})}))}])}));
//# sourceMappingURL=module.js.map